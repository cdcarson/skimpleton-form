/*
  CSS for component-free buttons and form controls. Note that:
  - Control sizing, and the associated padding and rounding 
  are based on the inherited font size. So...
    - You can do something like `class="ctl text-lg"` using the tailwind font size utilities.
    - You can use `class="ctl text-base"` to reset the base font-size with an container that
    has a different font-size.
  - Other properties are similarly overridable with tailwind classes.
*/

@layer components {
  html {
    --ctl-transition: all 150ms ease-in-out;
    --ctl-border-width: 1px;
    --ctl-line-height: 1.5;
    --ctl-padding-inline: 0.75em;
    --ctl-padding-block: 0.375em;
    --ctl-border-radius: 0.25em;
    --ctl-flex-gap: 0.375em;
    --ctl-min-height: calc(
      var(--ctl-line-height) * 1em + var(--ctl-padding-block) * 2 +
        var(--ctl-border-width) * 2
    );
    --ctl-focus-ring-width: 0.25rem;
    --ctl-focus-ring-style: solid;
    --ctl-focus-ring-offset: 0;
    --ctl-disabled-opacity: 0.33;
    --ctl-select-caret: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="%23737373"  viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/></svg>');
    --ctl-check: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='m6 10 3 3 6-6'/%3e%3c/svg%3e");
    --ctl-radio: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='2' fill='%23fff'/%3e%3c/svg%3e");
  }

  .control {
    @apply block min-h-[var(--ctl-min-height)] w-full max-w-full appearance-none rounded-[var(--ctl-border-radius)] border-[length:var(--ctl-border-width)] border-gray-300 bg-white px-[var(--ctl-padding-inline)] py-[var(--ctl-padding-block)] leading-[var(--ctl-line-height)] text-gray-700 ring-blue-500/50 transition-all outline-none focus-visible:ring-4 disabled:pointer-events-none disabled:opacity-33 dark:border-gray-500 dark:bg-black dark:text-gray-300 dark:disabled:opacity-50 [&.invalid]:border-red-500 [&.invalid]:ring-red-500/50;
  }

  .control:not(select):not(
      input[type='file'],
      input[type='color'],
      input[type='checkbox'],
      input[type='radio']
    ):read-only {
    @apply bg-gray-100 ring-black/20 dark:bg-gray-900 dark:ring-white/20;
  }
  .control:is(select):not([multiple]) {
    @apply bg-[url:var(--ctl-select-caret)] bg-[length:1em] bg-[right_1em_center] bg-no-repeat pr-[2.25em];
  }
  .control:is(input[type='file']) {
    @apply cursor-pointer file:bg-blue-600 file:px-2 file:py-1 file:text-xs file:text-white hover:file:bg-blue-700;
  }
  .control:is(input[type='color']) {
    @apply inline-block h-[var(--ctl-min-height)] w-[var(--ctl-min-height)] shrink-0 cursor-pointer px-0 py-0 [&::-webkit-color-swatch]:border-0 [&::-webkit-color-swatch-wrapper]:p-0;
  }
  .control:is(input[type='checkbox'], input[type='radio']) {
    @apply inline-block aspect-square min-h-0 w-[1em] shrink-0 bg-cover bg-center bg-no-repeat p-0 checked:border-blue-500 checked:bg-blue-500 [&.invalid]:checked:border-red-500 [&.invalid]:checked:bg-red-500;
    &:is(input[type='checkbox']):checked {
      @apply bg-[url:var(--ctl-check)];
    }
    &:is(input[type='radio']):checked {
      @apply bg-[url:var(--ctl-radio)];
    }
    &:is(input[type='radio']) {
      @apply rounded-full;
    }
  }
  label:has(> .control[type='checkbox'], > .control[type='radio']) {
    @apply flex items-center gap-x-[var(--ctl-flex-gap)] leading-[var(--ctl-line-height)] text-gray-700 dark:text-gray-300;

    &:has(> .control[disabled]) {
      & > .ctl {
        @apply opacity-100;
      }
      @apply opacity-33;
    }
  }
  .button {
    @apply inline-flex min-h-[var(--ctl-min-height)] cursor-pointer appearance-none items-center justify-center gap-x-[var(--ctl-flex-gap)] rounded-[var(--ctl-border-radius)] border-[length:var(--ctl-border-width)] border-gray-300 bg-white bg-clip-border px-[var(--ctl-padding-inline)] py-[var(--ctl-padding-block)] text-base leading-[var(--ctl-line-height)] text-gray-700 no-underline ring-blue-500/50 transition-all outline-none hover:bg-gray-100 focus-visible:ring-4 disabled:pointer-events-none disabled:opacity-33 disabled:ring-0 dark:border-gray-500 dark:bg-black dark:text-gray-300 dark:hover:bg-gray-900 dark:disabled:opacity-50 [&.active]:bg-gray-900 [&.active]:text-white [&.disabled]:pointer-events-none [&.disabled]:opacity-33 [&.disabled]:ring-0 dark:[&.disabled]:opacity-50;
  }

  .button.button-xs {
    @apply text-xs;
  }

  .button.button-sm {
    @apply text-sm;
  }

  .button.button-lg {
    @apply text-lg;
  }

  .button.button-xl {
    @apply text-xl;
  }

  .button.button-primary {
    @apply border-transparent bg-blue-600 text-white hover:bg-blue-700 [&.active]:bg-blue-900;
  }
  .button.button-primary-outline {
    @apply border-blue-600 bg-transparent text-blue-600 hover:bg-blue-50 hover:text-blue-800 dark:text-blue-300 dark:hover:bg-blue-950 dark:hover:text-blue-200 [&.active]:border-transparent [&.active]:bg-blue-800 [&.active]:text-white;
  }

  .button.button-destructive {
    @apply border-transparent bg-red-600 text-white hover:bg-red-700 [&.active]:bg-red-900;
  }

  .button.button-destructive-outline {
    @apply border-red-600 bg-transparent text-red-600 hover:bg-red-50 hover:text-red-800 dark:text-red-300 dark:hover:bg-red-950 dark:hover:text-red-200 [&.active]:border-transparent [&.active]:bg-red-800 [&.active]:text-white;
  }

  .button.button-dark {
    @apply border-transparent bg-gray-800 text-white hover:bg-gray-900 [&.active]:bg-black;
  }
  .button.button-ghost {
    @apply border-transparent bg-transparent text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-900 dark:active:bg-gray-800 [&.active]:bg-gray-200;
  }

  ul.control-group {
    @apply flex divide-x divide-gray-300;

    & > li.text {
      @apply block min-h-[var(--ctl-min-height)] min-w-[var(--ctl-min-height)] rounded-[var(--ctl-border-radius)] border-[length:var(--ctl-border-width)] border-gray-300 bg-gray-100 px-[var(--ctl-padding-inline)] py-[var(--ctl-padding-block)] text-gray-600 dark:border-gray-500 dark:bg-gray-900 dark:text-gray-400;
    }
    & > li.text:first-child {
      @apply rounded-tl-[var(--ctl-border-radius)] rounded-bl-[var(--ctl-border-radius)];
    }
    & > li.text:last-child {
      @apply rounded-tr-[var(--ctl-border-radius)] rounded-br-[var(--ctl-border-radius)];
    }
    & > li:not(.text) {
      & .button,
      & .control {
        @apply rounded-none border-r-0 border-l-0 ring-inset;
      }
    }
    & > li:not(.text):last-child {
      & .button,
      & .control {
        @apply rounded-tr-[var(--ctl-border-radius)] rounded-br-[var(--ctl-border-radius)] border-r-[length:var(--ctl-border-width)];
      }
    }
    & > li:not(.text):first-child {
      & .button,
      & .control {
        @apply rounded-tl-[var(--ctl-border-radius)] rounded-bl-[var(--ctl-border-radius)] border-l-[length:var(--ctl-border-width)];
      }
    }
  }

  ul.menu {
    @apply space-y-0.5 rounded-[var(--ctl-border-radius)] border-[length:var(--ctl-border-width)] border-gray-300 bg-white py-[var(--ctl-padding-block)] dark:border-gray-500 dark:bg-black;

    & > li.text {
      @apply px-[var(--ctl-padding-inline)] py-[var(--ctl-padding-block)];
    }
    & > li.divider > hr {
      @apply text-gray-300 dark:text-gray-500;
    }
    & > li:not(.text, .divider) {
      & > a,
      & > button {
        @apply flex min-h-[var(--ctl-min-height)] w-full cursor-pointer appearance-none items-center justify-start gap-x-[var(--ctl-flex-gap)] bg-white bg-clip-border px-[var(--ctl-padding-inline)] py-[var(--ctl-padding-block)] leading-[var(--ctl-line-height)] text-gray-700 no-underline ring-blue-500/50 transition-all outline-none ring-inset hover:bg-gray-300 focus-visible:ring-4 disabled:pointer-events-none disabled:opacity-33 dark:bg-black dark:text-gray-300 dark:hover:bg-gray-700 [&.active]:bg-blue-600 [&.active]:text-white [&.active]:ring-white/50 [&.disabled]:pointer-events-none [&.disabled]:opacity-33;
      }
    }
  }
}
